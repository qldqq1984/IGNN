source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S5/Table_S5_Multivariate Cox proportional hazards regression analysis.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S5/Table_S5_Multivariate Cox proportional hazards regression analysis.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S5/Table_S5_Multivariate Cox proportional hazards regression analysis.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S5/Table_S5_Multivariate Cox proportional hazards regression analysis.R")
summary(res.cox)
pbc<-pbc_train_TACSRidge
pbc$age <- ifelse(pbc$age  > 50, 1, 0)
pbc$age <- factor(pbc$age,labels=c('1','2'))
pbc$type <- factor(pbc$type,labels=c('1','2','3','4'))
pbc$size <- factor(pbc$size,labels=c('1','2','3'))
pbc$lym <- factor(pbc$lym,labels=c('1','2', '3'))
pbc$stage <- factor(pbc$stage,labels=c('1','2','3'))
pbc$grade <- factor(pbc$grade,labels=c('1','2','3'))
pbc$Chemotherapy <- factor(pbc$Chemotherapy,labels=c('1','2'))
pbc$Radiation <- factor(pbc$Radiation,labels=c('1','2'))
pbc$model_risk <- factor(pbc_train_TACSRidge$model_risk,labels=c('1','2'))
res.cox <- coxph(Surv(DFS, STATUS) ~ type + size + lym + stage + grade + age + Chemotherapy + Radiation + model_risk,data = pbc)
summary(res.cox)
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S5/Table_S5_Multivariate Cox proportional hazards regression analysis.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S5/Table_S5_Multivariate Cox proportional hazards regression analysis.R")
summary(TACS_data_training_results)
TACS_data_training$age <- ifelse(TACS_data_training$age  > 50, 1, 0)
TACS_data_training$age <- factor(TACS_data_training$age,labels=c('1','2'))
TACS_data_training$type <- factor(TACS_data_training$type,labels=c('1','2','3','4'))
TACS_data_training$size <- factor(TACS_data_training$size,labels=c('1','2','3'))
TACS_data_training$lym <- factor(TACS_data_training$lym,labels=c('1','2', '3'))
TACS_data_training$stage <- factor(TACS_data_training$stage,labels=c('1','2','3'))
TACS_data_training$grade <- factor(TACS_data_training$grade,labels=c('1','2','3'))
TACS_data_training$Chemotherapy <- factor(TACS_data_training$Chemotherapy,labels=c('1','2'))
TACS_data_training$Radiation <- factor(TACS_data_training$Radiation,labels=c('1','2'))
TACS_data_training <- read.xlsx( Data_file , sheet = "TACS_training_cohort")
IGNN_data_training <- read.xlsx( Data_file , sheet = "IGNN_training_cohort")
# Validation (n=264)
TACS_data_validation <- read.xlsx( Data_file , sheet = "TACS_validation_cohort")
IGNN_data_validation <- read.xlsx( Data_file , sheet = "IGNN_validation_cohort")
View(IGNN_data_training)
TACS_data_training$age <- ifelse(TACS_data_training$age  > 50, 1, 0)
TACS_data_training$age <- factor(TACS_data_training$age,labels=c('1','2'))
TACS_data_training$type <- factor(TACS_data_training$type,labels=c('1','2','3','4'))
TACS_data_training$size <- factor(TACS_data_training$size,labels=c('1','2','3'))
TACS_data_training$lym <- factor(TACS_data_training$lym,labels=c('1','2', '3'))
TACS_data_training$stage <- factor(TACS_data_training$stage,labels=c('1','2','3'))
TACS_data_training$grade <- factor(TACS_data_training$grade,labels=c('1','2','3'))
TACS_data_training$Chemotherapy <- factor(TACS_data_training$Chemotherapy,labels=c('1','2'))
TACS_data_training$Radiation <- factor(TACS_data_training$Radiation,labels=c('1','2'))
TACS_data_training$model_risk <- factor(TACS_data_training$model_risk,labels=c('1','2'))
TACS_data_training_results <- coxph(Surv(DFS, STATUS) ~ type + size + lym + stage + grade + age + Chemotherapy + Radiation + model_risk,data = TACS_data_training)
summary(TACS_data_training_results)
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S5/Table_S5_Multivariate Cox proportional hazards regression analysis.R")
summary(TACS_data_training_results)
TACS_data_validation$age <- ifelse(TACS_data_validation$age  > 50, 1, 0)
TACS_data_validation$age <- factor(TACS_data_validation$age,labels=c('1','2'))
TACS_data_validation$type <- factor(TACS_data_validation$type,labels=c('1','2','3','4'))
TACS_data_validation$size <- factor(TACS_data_validation$size,labels=c('1','2','3'))
TACS_data_validation$lym <- factor(TACS_data_validation$lym,labels=c('1','2', '3'))
TACS_data_validation$stage <- factor(TACS_data_validation$stage,labels=c('1','2','3'))
TACS_data_validation$grade <- factor(TACS_data_validation$grade,labels=c('1','2','3'))
TACS_data_validation$Chemotherapy <- factor(TACS_data_validation$Chemotherapy,labels=c('1','2'))
TACS_data_validation$Radiation <- factor(TACS_data_validation$Radiation,labels=c('1','2'))
TACS_data_validation$model_risk <- factor(TACS_data_validation$model_risk,labels=c('1','2'))
TACS_data_validation_results <- coxph(Surv(DFS, STATUS) ~ type + size + lym + stage + grade + age + Chemotherapy + Radiation + model_risk,data = TACS_data_validation)
summary(TACS_data_validation_results)
IGNN_data_training$age <- ifelse(IGNN_data_training$age  > 50, 1, 0)
IGNN_data_training$age <- factor(IGNN_data_training$age,labels=c('1','2'))
IGNN_data_training$type <- factor(IGNN_data_training$type,labels=c('1','2','3','4'))
IGNN_data_training$size <- factor(IGNN_data_training$size,labels=c('1','2','3'))
IGNN_data_training$lym <- factor(IGNN_data_training$lym,labels=c('1','2', '3'))
IGNN_data_training$stage <- factor(IGNN_data_training$stage,labels=c('1','2','3'))
IGNN_data_training$grade <- factor(IGNN_data_training$grade,labels=c('1','2','3'))
IGNN_data_training$Chemotherapy <- factor(IGNN_data_training$Chemotherapy,labels=c('1','2'))
IGNN_data_training$Radiation <- factor(IGNN_data_training$Radiation,labels=c('1','2'))
IGNN_data_training$model_risk <- factor(IGNN_data_training$model_risk,labels=c('1','2'))
IGNN_data_training_results <- coxph(Surv(DFS, STATUS) ~ type + size + lym + stage + grade + age + Chemotherapy + Radiation + model_risk,data = IGNN_data_training)
summary(IGNN_data_training_results)
IGNN_data_validation$age <- ifelse(IGNN_data_validation$age  > 50, 1, 0)
IGNN_data_validation$age <- factor(IGNN_data_validation$age,labels=c('1','2'))
IGNN_data_validation$type <- factor(IGNN_data_validation$type,labels=c('1','2','3','4'))
IGNN_data_validation$size <- factor(IGNN_data_validation$size,labels=c('1','2','3'))
IGNN_data_validation$lym <- factor(IGNN_data_validation$lym,labels=c('1','2', '3'))
IGNN_data_validation$stage <- factor(IGNN_data_validation$stage,labels=c('1','2','3'))
IGNN_data_validation$grade <- factor(IGNN_data_validation$grade,labels=c('1','2','3'))
IGNN_data_validation$Chemotherapy <- factor(IGNN_data_validation$Chemotherapy,labels=c('1','2'))
IGNN_data_validation$Radiation <- factor(IGNN_data_validation$Radiation,labels=c('1','2'))
IGNN_data_validation$model_risk <- factor(IGNN_data_validation$model_risk,labels=c('1','2'))
IGNN_data_validation_results <- coxph(Surv(DFS, STATUS) ~ type + size + lym + stage + grade + age + Chemotherapy + Radiation + model_risk,data = IGNN_data_validation)
summary(IGNN_data_validation_results)
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S5/Table_S5_Multivariate Cox proportional hazards regression analysis.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S6/Table_S6.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S6/Table_S6.R")
quiteROCFunc( data.frame(Y = TACS_data$y, risk_groups = TACS_data$model_risk), group = "Y", var = "risk_groups", threshold = 0.0)$result
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S6/Table_S6.R")
quiteROCFunc( data, group = "Y", var = "risk_groups", threshold = 0.0)$result
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S6/Table_S6.R")
quiteROCFunc( data, group = "Y", var = "risk_groups", threshold = 0.0)$result
tpbc1 <-  read.xlsx( "G:/博士论文5/NC_review1/FigsandTables/pre_validation/data/test_cohort_TACSRidge_fold_3cv_1.xlsx", sheet = 1)
tpbc1$testcohort_TACSRidge_score <- tpbc1$testcohort_TACSRidge_score -(-0.145)
tpbc2 <-  read.xlsx( "G:/博士论文5/NC_review1/FigsandTables/pre_validation/data/test_cohort_TACSRidge_fold_3cv_2.xlsx", sheet = 1)
tpbc2$testcohort_TACSRidge_score <- tpbc2$testcohort_TACSRidge_score -(-0.1056)
tpbc3 <-  read.xlsx( "G:/博士论文5/NC_review1/FigsandTables/pre_validation/data/test_cohort_TACSRidge_fold_3cv_3.xlsx", sheet = 1)
tpbc3$testcohort_TACSRidge_score <- tpbc3$testcohort_TACSRidge_score -(-0.169)
pbc1 <- rbind(tpbc1,tpbc2,tpbc3)
Times1 <- 60;
DFS1 <- as.numeric(pbc1$DFS);
Y1 <- ifelse(DFS1 <=60,1,0);
STATUS1 <- as.numeric(pbc1$STATUS);
factors1 <- as.numeric(pbc1$testcohort_TACSRidge_score);
risk_groups1<- as.numeric(pbc1$testcohort_TACSRidge_risk);
Patients1 <- ifelse(STATUS1 ==0, "Non-recurrence", "Recurrence")
fiveys_AUC1<-data.frame(Y1,risk_groups1)
score1 <-timeROC(T=DFS1,delta=STATUS1,marker=risk_groups1,cause=1,weighting="marginal",times=Times1,iid=TRUE)
CI_L <-confint(score1)$CI_AUC[1] / 100
CI_H <-confint(score1)$CI_AUC[2] / 100
AUC1_info <-c(score1$AUC[2],CI_L,CI_H)
d1<-data.frame(Y1,risk_groups1)
quiteROCFunc(d1, group = "Y1", var = "risk_groups1", threshold = 0.5)$result
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S6/Table_S6.R")
quiteROCFunc( data, group = "Y", var = "risk_groups", threshold = 0.5)$result
tpbc1 <-  read.xlsx( "G:/博士论文5/NC_review1/FigsandTables/pre_validation/data/test_cohort_TACSRidge_fold_3cv_1.xlsx", sheet = 1)
tpbc1$testcohort_TACSRidge_score <- tpbc1$testcohort_TACSRidge_score -(-0.145)
tpbc2 <-  read.xlsx( "G:/博士论文5/NC_review1/FigsandTables/pre_validation/data/test_cohort_TACSRidge_fold_3cv_2.xlsx", sheet = 1)
tpbc2$testcohort_TACSRidge_score <- tpbc2$testcohort_TACSRidge_score -(-0.1056)
tpbc3 <-  read.xlsx( "G:/博士论文5/NC_review1/FigsandTables/pre_validation/data/test_cohort_TACSRidge_fold_3cv_3.xlsx", sheet = 1)
tpbc3$testcohort_TACSRidge_score <- tpbc3$testcohort_TACSRidge_score -(-0.169)
pbc1 <- rbind(tpbc1,tpbc2,tpbc3)
Times1 <- 60;
DFS1 <- as.numeric(pbc1$DFS);
Y1 <- ifelse(DFS1 <=60,1,0);
STATUS1 <- as.numeric(pbc1$STATUS);
factors1 <- as.numeric(pbc1$testcohort_TACSRidge_score);
risk_groups1<- as.numeric(pbc1$testcohort_TACSRidge_risk);
Patients1 <- ifelse(STATUS1 ==0, "Non-recurrence", "Recurrence")
fiveys_AUC1<-data.frame(Y1,risk_groups1)
score1 <-timeROC(T=DFS1,delta=STATUS1,marker=risk_groups1,cause=1,weighting="marginal",times=Times1,iid=TRUE)
CI_L <-confint(score1)$CI_AUC[1] / 100
CI_H <-confint(score1)$CI_AUC[2] / 100
AUC1_info <-c(score1$AUC[2],CI_L,CI_H)
d1<-data.frame(Y1,risk_groups1)
quiteROCFunc(d1, group = "Y1", var = "risk_groups1", threshold = 0.5)$result
Nomogram_data_fold1 <- read.xlsx( Data_file , sheet = "Nomogram_fold1")
Nomogram_data_fold2 <- read.xlsx( Data_file , sheet = "Nomogram_fold2")
Nomogram_data_fold3 <- read.xlsx( Data_file , sheet = "Nomogram_fold3")
Nomogram_data <- rbind(Nomogram_data_fold1, Nomogram_data_fold2, Nomogram_data_fold3)
Y = Nomogram_data$y
risk_groups = Nomogram_data$model_risk
data <- data.frame(Y,risk_groups)
quiteROCFunc( data, group = "Y", var = "risk_groups", threshold = 0.5)$result
IGNN_data_fold1 <- read.xlsx( Data_file , sheet = "IGNN_fold1")
IGNN_data_fold2 <- read.xlsx( Data_file , sheet = "IGNN_fold2")
IGNN_data_fold3 <- read.xlsx( Data_file , sheet = "IGNN_fold3")
IGNN_data <- rbind(IGNN_data_fold1, IGNN_data_fold2, IGNN_data_fold3)
Y = IGNN_data$y
risk_groups = IGNN_data$model_risk
data <- data.frame(Y,risk_groups)
quiteROCFunc( data, group = "Y", var = "risk_groups", threshold = 0.5)$result
IGNNE_data_fold1 <- read.xlsx( Data_file , sheet = "IGNNE_fold1")
IGNNE_data_fold2 <- read.xlsx( Data_file , sheet = "IGNNE_fold2")
IGNNE_data_fold3 <- read.xlsx( Data_file , sheet = "IGNNE_fold3")
IGNNE_data <- rbind(IGNNE_data_fold1, IGNNE_data_fold2, IGNNE_data_fold3)
Y = IGNNE_data$y
risk_groups = IGNNE_data$model_risk
data <- data.frame(Y,risk_groups)
quiteROCFunc( data, group = "Y", var = "risk_groups", threshold = 0.5)$result
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/TACS_Nomogram_performance/external_validation.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/IGNN_IGNNE_performance/external_validation.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S7/Table_S7.R")
TACS_data_training <- read.xlsx( Data_file , sheet = "TACS_training_cohort")
Nomogram_data_training <- read.xlsx( Data_file , sheet = "Nomogram_training_cohort")
IGNN_data_training <- read.xlsx( Data_file , sheet = "IGNN_training_cohort")
IGNNE_data_training <- read.xlsx( Data_file , sheet = "IGNNE_training_cohort")
TACS_data_training <- read.xlsx( Data_file , sheet = "TACS_training_cohort")
TACS_data_training <- read.xlsx( Data_file , sheet = "TACS_training_cohort")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S7/Table_S7.R")
quiteROCFunc <- quietly(ROCStatFunc2)
Nomogram_data_training <- read.xlsx( Data_file , sheet = "Nomogram_training_cohort")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/experiments/data_analysis/Table_S6/Table_S6.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/Souce_Data_analysis/Table_S5/Table_S5_Multivariate Cox proportional hazards regression analysis.R")
summary(TACS_data_training_results)
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/Souce_Data_analysis/Table_S6/Table_S6.R")
library(tidyverse)
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/Souce_Data_analysis/Table_S6/Table_S6.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/Souce_Data_analysis/Table_S6/Table_S6.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/Souce_Data_analysis/Table_S6/Table_S6.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/Souce_Data_analysis/Table_S6/Table_S6.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/Souce_Data_analysis/Table_S6/Table_S6.R")
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/Souce_Data_analysis/Table_S6/Table_S6.R")
quiteROCFunc( data, group = "Y", var = "risk_groups", threshold = 0.5)$result
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/Source_Data_analysis/Table_S5/Table_S5_Multivariate Cox proportional hazards regression analysis.R")
summary(IGNN_data_validation_results)
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/Source_Data_analysis/Table_S6/Table_S6.R")
quiteROCFunc( data, group = "Y", var = "risk_groups", threshold = 0.5)$result
source("G:/博士论文5/NC_review1/IGNNandIGNNE_final_v1/Source_Data_analysis/Table_S7/Table_S7.R")
quiteROCFunc( data, group = "Y", var = "risk_groups", threshold = -0.4299)$result
